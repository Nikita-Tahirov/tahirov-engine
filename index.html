<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Tahirov Engine</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Raleway:wght@400;500;600&family=Unbounded:wght@300;400;600;700&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="./styles/main.css">
    <link rel="stylesheet" href="./styles/modules/components.css">
    <link rel="stylesheet" href="./styles/modules/layout.css">
    <link rel="stylesheet" href="./styles/modules/library.css">

    <style>
        #crash-screen {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: #1a0505; color: #ff6b6b; z-index: 100000; padding: 40px;
            font-family: monospace; white-space: pre-wrap; overflow: auto;
        }
        #loading-overlay {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(5, 2, 10, 0.9); z-index: 5000;
            flex-direction: column; justify-content: center; align-items: center;
            backdrop-filter: blur(10px); color: white; font-family: 'Unbounded', sans-serif;
        }
        .spinner {
            width: 50px; height: 50px; border: 5px solid rgba(255,255,255,0.3);
            border-top: 5px solid var(--accent-secondary, #0099ff); border-radius: 50%;
            animation: spin 1s linear infinite; margin-bottom: 20px;
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body>
    <div id="crash-screen"><h2>ðŸ”¥ Critical Error</h2><div id="error-details"></div></div>
    <script>
        function showError(msg) { document.getElementById('crash-screen').style.display='block'; document.getElementById('error-details').textContent+=`ðŸ”´ ${msg}\n`; }
        window.onerror = (m,s,l) => showError(`${m}\n${s}:${l}`);
        window.addEventListener('error', e => { if(e.target.tagName==='SCRIPT') showError(`Failed to load: ${e.target.src}`); }, true);
    </script>

    <div id="loading-overlay">
        <div class="spinner"></div>
        <div id="loading-text">Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ°...</div>
    </div>

    <svg id="global-svg-defs" style="width:0;height:0;position:absolute;" aria-hidden="true" focusable="false">
        <linearGradient id="grad-icon" x1="0%" y1="0%" x2="100%" y2="100%">
            <stop offset="0%" style="stop-color: var(--accent-secondary); stop-opacity:1" />
            <stop offset="100%" style="stop-color: var(--accent-primary); stop-opacity:1" />
        </linearGradient>
    </svg>

    <div id="app"></div>

    <div class="ui-controls-left">
        <button id="theme-toggle-btn" class="ui-btn" title="Ð¡Ð¼ÐµÐ½Ð¸Ñ‚ÑŒ Ñ‚ÐµÐ¼Ñƒ (M)">
            <svg viewBox="0 0 24 24" width="24" height="24">
                <path fill="currentColor" d="M12 3c-4.97 0-9 4.03-9 9s4.03 9 9 9c.83 0 1.5-.67 1.5-1.5 0-.39-.15-.74-.39-1.01-.23-.26-.38-.61-.38-.99 0-.83.67-1.5 1.5-1.5H16c2.76 0 5-2.24 5-5 0-4.42-4.03-8-9-8zm-5.5 9c-.83 0-1.5-.67-1.5-1.5S5.67 9 6.5 9 8 9.67 8 10.5 7.33 12 6.5 12zm3-4C8.67 8 8 7.33 8 6.5S8.67 5 9.5 5s1.5.67 1.5 1.5S10.33 8 9.5 8zm5 0c-.83 0-1.5-.67-1.5-1.5S13.67 5 14.5 5s1.5.67 1.5 1.5S15.33 8 14.5 8zm3 4c-.83 0-1.5-.67-1.5-1.5S16.67 9 17.5 9s1.5.67 1.5 1.5-.67 1.5-1.5 1.5z"/>
            </svg>
        </button>
        <button id="export-btn" class="ui-btn" title="ÐŸÐµÑ‡Ð°Ñ‚ÑŒ Ð² PDF">
            <svg viewBox="0 0 24 24" width="24" height="24">
                <path fill="currentColor" d="M19 8h-1V3H6v5H5c-1.66 0-3 1.34-3 3v6h4v4h12v-4h4v-6c0-1.66-1.34-3-3-3zM8 5h8v3H8V5zm8 12v2H8v-2h8zm2-2v-2H6v2H4v-4c0-.55.45-1 1-1h14c.55 0 1 .45 1 1v4h-2z"/>
            </svg>
        </button>
        <button id="pptx-btn" class="ui-btn" title="Ð¡ÐºÐ°Ñ‡Ð°Ñ‚ÑŒ PPTX">
            <svg viewBox="0 0 24 24" width="24" height="24">
                <path fill="currentColor" d="M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96zM17 13l-5 5-5-5h3V9h4v4h3z"/>
            </svg>
        </button>
        <button id="back-to-library-btn" class="ui-btn" title="ÐÐ°Ð·Ð°Ð´ Ðº Ð±Ð¸Ð±Ð»Ð¸Ð¾Ñ‚ÐµÐºÐµ (ESC)" style="display: none;">
            <svg viewBox="0 0 24 24" width="24" height="24">
                <path fill="currentColor" d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/>
            </svg>
        </button>
    </div>

    <div class="ui-controls-right">
        <button id="prev-slide-btn" class="ui-btn" title="ÐÐ°Ð·Ð°Ð´">
            <svg viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"/></svg>
        </button>
        <button id="next-slide-btn" class="ui-btn" title="Ð’Ð¿ÐµÑ€ÐµÐ´">
            <svg viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"/></svg>
        </button>
    </div>

    <script src="https://unpkg.com/html-to-image@1.11.11/dist/html-to-image.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/pptxgenjs@3.12.0/dist/pptxgen.bundle.js"></script>

    <script type="module" src="./src/core/Engine.js"></script>
</body>
</html>
